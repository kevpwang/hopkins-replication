---
title: "Replication of 'The Upside of Accents: Language, Inter-group Difference, and Attitudes toward Immigration'"
author: "Kevin Wang"
date: "4/14/2020"
output:
  bookdown::pdf_document2:
    keep_tex: true
bibliography: wang_draft.bib
biblio-style: "apalike"
link_citations: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(gt)
library(broom)
library(stargazer)
library(ggpubr)
library(sjPlot)
library(janitor)
library(rstanarm)
library(tidyverse)

# Read cleaned data from clean-data.

exp1_cleaned <- read_rds("clean-data/exp1_cleaned.rds") %>% 
  clean_names()
exp2_cleaned <- read_rds("clean-data/exp2_cleaned.rds") %>% 
  clean_names()
```

# Abstract

Hopkins (2015) finds that exposing survey respondents to video of an immigrant with "culturally distinctive" traits causes the respondents to adopt more inclusive attitudes toward immigration. I successfully replicated Hopkins's results and extended his model to account for varying levels of preexisting Spanish exposure among respondents that might influence their responses to such traits.

# Introduction

@hopkins builds on prior research and sociological theory suggesting that observation of immigrants' "culturally distinctive" traits induces anti-immigrant attitudes in members of society from the dominant cultural background. Hopkins seeks to empirically determine whether immigrants who appear more "culturally distinctive" generate more hostile responses. Specifically, noting the rapid growth of Hispanic immigration to the US, Hopkins shows a nationally representative sample of non-Hispanic Americans videos, adapted from an ABC news clip, of an "undocumented Hispanic immigrant" expressing support for assimilation and a path to citizenship. The video is edited such that the immigrant is blurred, appears either visibly dark- or light-skinned, and speaks either fluent Spanish, fluent but subtly accented English, or broken English. 8 percent of the sample, the control group, were not shown any video, while the remaining 92 percent was randomly assigned to one of six possible videos (combinations of skin tone and English fluency). After the video, the sample was surveyed about their opinion on a path to citizenship for undocumented immigrants, with answers corresponding to a numerical scale of 1 ("strongly oppose") to 4 ("strongly support"). They were also surveyed on five other immigration-related questions.

Hopkins runs a linear regression on attitudes toward a path to citizenship using skin tone, video language fluency, respondent years of education, conservatism, partisanship, race (white/black), and gender as explanatory variables. He also runs linear or logistic regressions between each of the other five questions and video language fluency. The principal results of the paper relate to the effect of skin tone and language. Hopkins finds that skin tone does not meaningfully shift change attitudes. Moreover, contrary to expectations that more distinctive traits would engender greater hostility, Hopkins finds no difference between exposure to fluent English or Spanish, and significantly increased support for a pathway to citizenship among those who heard broken English. Hopkins theorizes that rather than reinforce perceptions of cultural difference, a broken English speaker actually challenges stereotypes by exemplifying immigrants' desire to assimilate with American norms.

# Literature Review

Previous literature develops several theories which might explain intergroup conflict. The ethnocentrism-based approach, outlined in @kinderkam, holds that individuals are predisposed to divide society into in-groups and out-groups. On the other hand, other hypotheses, like @webercrocker, propound the primacy of skin-tone and argue that darker skin tone is determinative of more exclusionary attitudes.

# Replications

```{r Linear Q7 model, echo = FALSE}

# Regression analysis for Q7: path to citizenship 

exp1_q7 <- exp1_cleaned %>% 
  
  # Hopkins excludes Hispanics; sensible to exclude people who refused to answer Q7
  
  filter(ppethm != "Hispanic") %>% 
  filter(q7 != -1)

q7_model <- lm(q7 ~ dark + accented + spanish + no_video + years_educ + conservative + republican + 
                       black + male, data = exp1_q7)
```

## Table 1

```{r Replicate Table 1, echo = FALSE, result = "asis"}
stargazer(q7_model,
          title = "OLS Regression of Support for a Pathway to Naturalization on Indicators of Treatment
          Group Status and Other Independent Variables",
          header = FALSE
          )
```

## Figure 2

```{r Replicate Figure 2, echo = FALSE}
iv_list <- c("accented", "spanish", "no_video")
parameters <- tibble(condition = c("Accented English", "Fluent Spanish", "No Video (Control)"),
       coef = map_dbl(iv_list, ~filter(tidy(q7_model), term == .x) %>% pull(estimate)),
       sd = map_dbl(iv_list, ~filter(tidy(q7_model), term == .x) %>% pull(std.error))
       )
ggplot(parameters, aes(x = condition, y = coef)) +
  geom_col(alpha = 0.5, color = "black") +
  geom_errorbar(aes(ymin = coef - sd, ymax = coef + sd), size = 1, width = 0) +
  geom_errorbar(aes(ymin = coef - 2 * sd, ymax = coef + 2 * sd), width = 0) +
  scale_y_continuous(limits = c(-0.4, 0.4)) +
  labs(
    title = "Support Pathway to Naturalization",
    subtitle = "Subjects who heard broken English display significantly more pro-immigrant attitudes",
    x = "Treatment",
    y = "Difference from Fluent English"
    )
```

The gray bars depict the difference in subjects' support for a path to naturalization compared to that of subjects who saw a light-skinned immigrant fluently speaking English. Support is measured numerically from 1 (strongly oppose) to 4 (strongly support). The thick vertical lines represent the interval of one standard error, while the thin vertical lines represent the 95 percent conficence interval.

## Figure 3

```{r All models, echo = FALSE, cache = TRUE}

# Create models for all six questions.

q7_model <- stan_glm(q7 ~ dark + accented + spanish + no_video + years_educ + conservative + republican + 
                       black + male, data = exp1_q7, refresh = 0)

exp1_q8 <- exp1_cleaned %>% 
  filter(ppethm != "Hispanic") %>% 
  filter(q8 != -1)

q8_model <- stan_glm(q8 ~ dark + accented + spanish + no_video + years_educ + conservative + republican + 
                       black + male, data = exp1_q8, refresh = 0)

exp1_q9 <- exp1_cleaned %>% 
  filter(ppethm != "Hispanic") %>% 
  filter(q9 != -1)

q9_model <- stan_glm(q9 ~ dark + accented + spanish + no_video + years_educ + conservative + republican + 
                       black + male, data = exp1_q9, refresh = 0)

exp1_q10 <- exp1_cleaned %>% 
  filter(ppethm != "Hispanic") %>% 
  filter(q10 != -1)

q10_model <- stan_glm(q10 ~ dark + accented + spanish + no_video + years_educ + conservative + republican + 
                       black + male, data = exp1_q10, refresh = 0)

exp1_q12a <- exp1_cleaned %>% 
  filter(ppethm != "Hispanic") %>% 
  drop_na(q12a) %>% 
  filter(q12a != -1)

# Supposedly logistic, but for some reason the plot is of a linear analysis.

q12a_model <- stan_glm(q12a ~ dark + accented + spanish + no_video + years_educ + conservative + republican + 
                       black + male, data = exp1_q12a, refresh = 0)

exp1_q13 <- exp1_cleaned %>% 
  filter(ppethm != "Hispanic") %>% 
  filter(q13 != -1)

q13_model <- stan_glm(q13 ~ dark + accented + spanish + no_video + years_educ + conservative + republican + 
                       black + male, data = exp1_q13, refresh = 0)
```

```{r Replicate Figure 3, echo = FALSE}

# map() does not work here & nesting map() is probably not worth the
# trouble, especially since I'm not sure how to facet_wrap() geom_col()
# & give each graph its own separate title.

iv_list <- c("accented", "spanish", "no_video", "dark")
parameters <- tibble(condition = c("Accent", "Span.", "No Video", "Dark"),
       coef = map_dbl(iv_list, ~filter(tidy(q7_model), term == .x) %>% pull(estimate)),
       sd = map_dbl(iv_list, ~filter(tidy(q7_model), term == .x) %>% pull(std.error))
       ) %>%
  mutate(condition = factor(condition, levels = condition))

q7_plot <- ggplot(parameters, aes(x = condition, y = coef)) +
  geom_col(alpha = 0.5, color = "black") +
  geom_errorbar(aes(ymin = coef - sd, ymax = coef + sd), size = 1, width = 0) +
  geom_errorbar(aes(ymin = coef - 2 * sd, ymax = coef + 2 * sd), width = 0) +
  scale_y_continuous(limits = c(-0.4, 0.4)) +
  labs(
    title = "Support Pathway",
    x = "Treatment",
    y = "Difference from LS Fluent English"
    ) +
  theme(plot.title = element_text(size = 9),
        axis.title = element_text(size = 9),
        axis.text = element_text(size = 5)
        )

parameters <- tibble(condition = c("Accent", "Span.", "No Video", "Dark"),
       coef = map_dbl(iv_list, ~filter(tidy(q8_model), term == .x) %>% pull(estimate)),
       sd = map_dbl(iv_list, ~filter(tidy(q8_model), term == .x) %>% pull(std.error))
       ) %>% 
  mutate(condition = factor(condition, levels = condition))

q8_plot <- ggplot(parameters, aes(x = condition, y = coef)) +
  geom_col(alpha = 0.5, color = "black") +
  geom_errorbar(aes(ymin = coef - sd, ymax = coef + sd), size = 1, width = 0) +
  geom_errorbar(aes(ymin = coef - 2 * sd, ymax = coef + 2 * sd), width = 0) +
  scale_y_continuous(limits = c(-0.4, 0.4)) +
  labs(
    title = "Support Increased Immigration",
    x = "Treatment",
    y = "Difference from LS Fluent English"
    ) +
  theme(plot.title = element_text(size = 9),
        axis.title = element_text(size = 9),
        axis.text = element_text(size = 5)
        )

parameters <- tibble(condition = c("Accent", "Span.", "No Video", "Dark"),
       coef = map_dbl(iv_list, ~filter(tidy(q9_model), term == .x) %>% pull(estimate)),
       sd = map_dbl(iv_list, ~filter(tidy(q9_model), term == .x) %>% pull(std.error))
       ) %>% 
  mutate(condition = factor(condition, levels = condition))

q9_plot <- ggplot(parameters, aes(x = condition, y = coef)) +
  geom_col(alpha = 0.5, color = "black") +
  geom_errorbar(aes(ymin = coef - sd, ymax = coef + sd), size = 1, width = 0) +
  geom_errorbar(aes(ymin = coef - 2 * sd, ymax = coef + 2 * sd), width = 0) +
  scale_y_continuous(limits = c(-0.4, 0.3), breaks = c(-0.4, -0.2, 0.1, 0.2, 0.3)) +
  labs(
    title = "Don't Feel Threatened",
    x = "Treatment",
    y = "Difference from LS Fluent English"
    ) +
  theme(plot.title = element_text(size = 9),
        axis.title = element_text(size = 9),
        axis.text = element_text(size = 5)
        )

parameters <- tibble(condition = c("Accent", "Span.", "No Video", "Dark"),
       coef = map_dbl(iv_list, ~filter(tidy(q10_model), term == .x) %>% pull(estimate)),
       sd = map_dbl(iv_list, ~filter(tidy(q10_model), term == .x) %>% pull(std.error))
       ) %>% 
  mutate(condition = factor(condition, levels = condition))

q10_plot <- ggplot(parameters, aes(x = condition, y = coef)) +
  geom_col(alpha = 0.5, color = "black") +
  geom_errorbar(aes(ymin = coef - sd, ymax = coef + sd), size = 1, width = 0) +
  geom_errorbar(aes(ymin = coef - 2 * sd, ymax = coef + 2 * sd), width = 0) +
  scale_y_continuous(limits = c(-0.3, 0.3), breaks = c(-0.3, -0.1, 0.1, 0.3)) +
  labs(
    title = "Strengthen American Society",
    x = "Treatment",
    y = "Difference from LS Fluent English"
    ) +
  theme(plot.title = element_text(size = 9),
        axis.title = element_text(size = 9),
        axis.text = element_text(size = 5)
        )

parameters <- tibble(condition = c("Accent", "Span.", "No Video", "Dark"),
       coef = map_dbl(iv_list, ~filter(tidy(q12a_model), term == .x) %>% pull(estimate)),
       sd = map_dbl(iv_list, ~filter(tidy(q12a_model), term == .x) %>% pull(std.error))
       ) %>% 
  mutate(condition = factor(condition, levels = condition))

q12a_plot <- ggplot(parameters, aes(x = condition, y = coef)) +
  geom_col(alpha = 0.5, color = "black") +
  geom_errorbar(aes(ymin = coef - sd, ymax = coef + sd), size = 1, width = 0) +
  geom_errorbar(aes(ymin = coef - 2 * sd, ymax = coef + 2 * sd), width = 0) +
  scale_y_continuous(limits = c(-0.3, 0.3), breaks = c(-0.3, -0.1, 0.1, 0.3)) +
  labs(
    title = "Social Trust",
    x = "Treatment",
    y = "Difference from LS Fluent English"
    ) +
  theme(plot.title = element_text(size = 9),
        axis.title = element_text(size = 9),
        axis.text = element_text(size = 5)
        )

parameters <- tibble(condition = c("Accent", "Span.", "No Video", "Dark"),
       coef = map_dbl(iv_list, ~filter(tidy(q13_model), term == .x) %>% pull(estimate)),
       sd = map_dbl(iv_list, ~filter(tidy(q13_model), term == .x) %>% pull(std.error))
       ) %>% 
  mutate(condition = factor(condition, levels = condition))

q13_plot <- ggplot(parameters, aes(x = condition, y = coef)) +
  geom_col(alpha = 0.5, color = "black") +
  geom_errorbar(aes(ymin = coef - sd, ymax = coef + sd), size = 1, width = 0) +
  geom_errorbar(aes(ymin = coef - 2 * sd, ymax = coef + 2 * sd), width = 0) +
  scale_y_continuous(limits = c(-0.3, 0.3), breaks = c(-0.3, -0.1, 0.1, 0.3)) +
  labs(
    title = "Don't Take Jobs",
    x = "Treatment",
    y = "Difference from LS Fluent English"
    ) +
  theme(plot.title = element_text(size = 9),
        axis.title = element_text(size = 9),
        axis.text = element_text(size = 5)
        )

ggarrange(q7_plot, q12a_plot, q9_plot, q10_plot, q13_plot, q8_plot,
                   ncol = 3, nrow = 2)
```

## Figure 4

```{r Replicate Figure 4, echo = FALSE}
exp2_q7 <- exp2_cleaned %>% 
  filter(ppethm != "Hispanic") %>% 
  filter(q7 != -1)

q7_model <- stan_glm(q7 ~ accented + spanish + years_educ + conservative + democratic + 
                       male + black, data = exp2_q7, refresh = 0)

iv_list <- c("accented", "(Intercept)", "spanish")
parameters <- tibble(condition = c("Accent", "English", "Spanish"),
       coef = map_dbl(iv_list, ~filter(tidy(q7_model), term == .x) %>% pull(estimate)),
       sd = map_dbl(iv_list, ~filter(tidy(q7_model), term == .x) %>% pull(std.error))
       ) %>% 
  mutate(condition = factor(condition, levels = condition))
parameters[2,2] <- 0
parameters[2,3] <- 0

ggplot(parameters, aes(x = condition, y = coef)) +
  geom_col(alpha = 0.5, color = "black") +
  geom_errorbar(aes(ymin = coef - sd, ymax = coef + sd), size = 1, width = 0) +
  geom_errorbar(aes(ymin = coef - 2 * sd, ymax = coef + 2 * sd), width = 0) +
  scale_y_continuous(limits = c(-0.2, 0.3), breaks = c(-0.2, -0.1, 0.1, 0.2, 0.3)) +
  labs(
    title = "Support Pathway",
    subtitle = paste("mean = ", round(mean(exp2_q7$q7), 1), 
                     ", SD = ", round(sd(exp2_q7$q7), 1), sep = ""),
    x = "Treatment",
    y = "Difference from control (English)"
    )
```

# Replication Progress

The replication is based on @king. I was able to replicate all but three charts and tables from @hopkins. I am not able to replicate Appendix A, Figure 1 because it is not entirely clear where that data is in the dataset and how to process it, but I anticipate coming up with a method soon. I can only partially replicate Figure 4 and Appendix C, Table 4 because the method for calculating the six-question index is not specified anywhere in the paper; I may have to email Hopkins and ask. The only additional aspect I am unable to replicate is the "free step-down resampling method" for generating the appropriate corrected p-values for Figure 3.

# Extension

In both the August 2010 and January 2011 surveys, all respondents were asked the following question: "In your day-to-day life, how frequently do you hear Spanish spoken? Never or almost never, less than once a month, 1-3 times each month, at least once a week, or every day?" I extend @hopkins by incorporating responses to this question in the regression models for immigration-related questions.

This "familiarity with Spanish" question could be reasonably expected to be an important explainer of immigration attitudes. In each survey, approximately 35 percent of respondents heard Spanish spoken every day, and about another 30 percent heard Spanish spoken at least once a week. Therefore, the apparent lack of exclusionary responses to "culturally distinctive" traits may be influenced by such widespread familiarity with Spanish among respondents, whereas other respondents less familiar with Spanish in their daily lives may exhibit more exclusionary responses for which the current analysis is not accounting. There is evidence for hostile responses to specifically *non-familiar* culturally distinctive traits in an experimental setting. For example, @enos finds that when Spanish speakers were introduced to a predominantly white, upper-income subway commute route, overall attitudes toward immigration become more exclusionary. It might similarly be the case in @hopkins that the only reason why fluent Spanish and broken English treatments do not prompt hostility is because the vast majority of respondents were already familiar with Spanish.

```{r Exp 1 extension, echo = FALSE}

ext1_q7 <- exp1_cleaned %>% 
  
  # Hopkins excludes Hispanics; sensible to exclude people who refused to answer Q7
  
  filter(ppethm != "Hispanic") %>% 
  filter(q7 != -1 & q14 != -1)

q7_model <- stan_glm(q7 ~ dark + accented + q14 + spanish + no_video + years_educ + conservative + republican + 
                       black + male, data = ext1_q7, refresh = 0)

ext1_q8 <- exp1_cleaned %>% 
  filter(ppethm != "Hispanic") %>% 
  filter(q8 != -1)

q8_model <- stan_glm(q8 ~ dark + accented + q14 + spanish + no_video + years_educ + conservative + republican + 
                       black + male, data = ext1_q8, refresh = 0)

ext1_q9 <- exp1_cleaned %>% 
  filter(ppethm != "Hispanic") %>% 
  filter(q9 != -1)

q9_model <- stan_glm(q9 ~ dark + accented + q14 + spanish + no_video + years_educ + conservative + republican + 
                       black + male, data = ext1_q9, refresh = 0)

ext1_q10 <- exp1_cleaned %>% 
  filter(ppethm != "Hispanic") %>% 
  filter(q10 != -1)

q10_model <- stan_glm(q10 ~ dark + accented + q14 + spanish + no_video + years_educ + conservative + republican + 
                       black + male, data = ext1_q10, refresh = 0)

ext1_q12a <- exp1_cleaned %>% 
  filter(ppethm != "Hispanic") %>% 
  drop_na(q12a) %>% 
  filter(q12a != -1)

q12a_model <- stan_glm(q12a ~ dark + accented + q14 + spanish + no_video + years_educ + conservative + republican + 
                       black + male, data = ext1_q12a, refresh = 0)

ext1_q13 <- exp1_cleaned %>% 
  filter(ppethm != "Hispanic") %>% 
  filter(q13 != -1)

q13_model <- stan_glm(q13 ~ dark + accented + q14 + spanish + no_video + years_educ + conservative + republican + 
                       black + male, data = ext1_q13, refresh = 0)
```

```{r Exp 1 ext graph, echo = FALSE}

# map() does not work here & nesting map() is probably not worth the
# trouble, especially since I'm not sure how to facet_wrap() geom_col()
# & give each graph its own separate title.

iv_list <- c("accented", "no_video", "q14")
parameters <- tibble(condition = c("Accent", "No Video", "Span. Familiar"),
       coef = map_dbl(iv_list, ~filter(tidy(q7_model), term == .x) %>% pull(estimate)),
       sd = map_dbl(iv_list, ~filter(tidy(q7_model), term == .x) %>% pull(std.error))
       ) %>%
  mutate(condition = factor(condition, levels = condition))

q7_plot <- ggplot(parameters, aes(x = condition, y = coef)) +
  geom_col(alpha = 0.5, color = "black") +
  geom_errorbar(aes(ymin = coef - sd, ymax = coef + sd), size = 1, width = 0) +
  geom_errorbar(aes(ymin = coef - 2 * sd, ymax = coef + 2 * sd), width = 0) +
  scale_y_continuous(limits = c(-0.4, 0.4)) +
  labs(
    title = "Support Pathway",
    x = "Treatment",
    y = "Difference from LS Fluent English"
    ) +
  theme(plot.title = element_text(size = 9),
        axis.title = element_text(size = 9),
        axis.text = element_text(size = 5)
        )

parameters <- tibble(condition = c("Accent", "No Video", "Span. Familiar"),
       coef = map_dbl(iv_list, ~filter(tidy(q8_model), term == .x) %>% pull(estimate)),
       sd = map_dbl(iv_list, ~filter(tidy(q8_model), term == .x) %>% pull(std.error))
       ) %>% 
  mutate(condition = factor(condition, levels = condition))

q8_plot <- ggplot(parameters, aes(x = condition, y = coef)) +
  geom_col(alpha = 0.5, color = "black") +
  geom_errorbar(aes(ymin = coef - sd, ymax = coef + sd), size = 1, width = 0) +
  geom_errorbar(aes(ymin = coef - 2 * sd, ymax = coef + 2 * sd), width = 0) +
  scale_y_continuous(limits = c(-0.4, 0.4)) +
  labs(
    title = "Support Increased Immigration",
    x = "Treatment",
    y = "Difference from LS Fluent English"
    ) +
  theme(plot.title = element_text(size = 9),
        axis.title = element_text(size = 9),
        axis.text = element_text(size = 5)
        )

parameters <- tibble(condition = c("Accent", "No Video", "Span. Familiar"),
       coef = map_dbl(iv_list, ~filter(tidy(q9_model), term == .x) %>% pull(estimate)),
       sd = map_dbl(iv_list, ~filter(tidy(q9_model), term == .x) %>% pull(std.error))
       ) %>% 
  mutate(condition = factor(condition, levels = condition))

q9_plot <- ggplot(parameters, aes(x = condition, y = coef)) +
  geom_col(alpha = 0.5, color = "black") +
  geom_errorbar(aes(ymin = coef - sd, ymax = coef + sd), size = 1, width = 0) +
  geom_errorbar(aes(ymin = coef - 2 * sd, ymax = coef + 2 * sd), width = 0) +
  scale_y_continuous(limits = c(-0.4, 0.3), breaks = c(-0.4, -0.2, 0.1, 0.2, 0.3)) +
  labs(
    title = "Don't Feel Threatened",
    x = "Treatment",
    y = "Difference from LS Fluent English"
    ) +
  theme(plot.title = element_text(size = 9),
        axis.title = element_text(size = 9),
        axis.text = element_text(size = 5)
        )

parameters <- tibble(condition = c("Accent", "No Video", "Span. Familiar"),
       coef = map_dbl(iv_list, ~filter(tidy(q10_model), term == .x) %>% pull(estimate)),
       sd = map_dbl(iv_list, ~filter(tidy(q10_model), term == .x) %>% pull(std.error))
       ) %>% 
  mutate(condition = factor(condition, levels = condition))

q10_plot <- ggplot(parameters, aes(x = condition, y = coef)) +
  geom_col(alpha = 0.5, color = "black") +
  geom_errorbar(aes(ymin = coef - sd, ymax = coef + sd), size = 1, width = 0) +
  geom_errorbar(aes(ymin = coef - 2 * sd, ymax = coef + 2 * sd), width = 0) +
  scale_y_continuous(limits = c(-0.3, 0.3), breaks = c(-0.3, -0.1, 0.1, 0.3)) +
  labs(
    title = "Strengthen American Society",
    x = "Treatment",
    y = "Difference from LS Fluent English"
    ) +
  theme(plot.title = element_text(size = 9),
        axis.title = element_text(size = 9),
        axis.text = element_text(size = 5)
        )

parameters <- tibble(condition = c("Accent", "No Video", "Span. Familiar"),
       coef = map_dbl(iv_list, ~filter(tidy(q12a_model), term == .x) %>% pull(estimate)),
       sd = map_dbl(iv_list, ~filter(tidy(q12a_model), term == .x) %>% pull(std.error))
       ) %>% 
  mutate(condition = factor(condition, levels = condition))

q12a_plot <- ggplot(parameters, aes(x = condition, y = coef)) +
  geom_col(alpha = 0.5, color = "black") +
  geom_errorbar(aes(ymin = coef - sd, ymax = coef + sd), size = 1, width = 0) +
  geom_errorbar(aes(ymin = coef - 2 * sd, ymax = coef + 2 * sd), width = 0) +
  scale_y_continuous(limits = c(-0.3, 0.3), breaks = c(-0.3, -0.1, 0.1, 0.3)) +
  labs(
    title = "Social Trust",
    x = "Treatment",
    y = "Difference from LS Fluent English"
    ) +
  theme(plot.title = element_text(size = 9),
        axis.title = element_text(size = 9),
        axis.text = element_text(size = 5)
        )

parameters <- tibble(condition = c("Accent", "No Video", "Span. Familiar"),
       coef = map_dbl(iv_list, ~filter(tidy(q13_model), term == .x) %>% pull(estimate)),
       sd = map_dbl(iv_list, ~filter(tidy(q13_model), term == .x) %>% pull(std.error))
       ) %>% 
  mutate(condition = factor(condition, levels = condition))

q13_plot <- ggplot(parameters, aes(x = condition, y = coef)) +
  geom_col(alpha = 0.5, color = "black") +
  geom_errorbar(aes(ymin = coef - sd, ymax = coef + sd), size = 1, width = 0) +
  geom_errorbar(aes(ymin = coef - 2 * sd, ymax = coef + 2 * sd), width = 0) +
  scale_y_continuous(limits = c(-0.3, 0.3), breaks = c(-0.3, -0.1, 0.1, 0.3)) +
  labs(
    title = "Don't Take Jobs",
    x = "Treatment",
    y = "Difference from LS Fluent English"
    ) +
  theme(plot.title = element_text(size = 9),
        axis.title = element_text(size = 9),
        axis.text = element_text(size = 5)
        )

ggarrange(q7_plot, q12a_plot, q9_plot, q10_plot, q13_plot, q8_plot,
                   ncol = 3, nrow = 2)
```

I modified the regressions on all six original questions from @hopkins to include familiarity with Spanish. The question is coded on a numerical scale from 1 to 5 with 5 as hearing Spanish "every day". The results of the analysis are surprising and run counter to expectations. Since @hopkins finds that responses to the "increased legal immigration" question are correlated differently than the other questions, we will set aside that question as similarly anomalous. As the figure above shows, on all four remaining immigration-related questions, the effect of familarity with Spanish is exactly opposite that of accented English. Respondents who are more familiar with Spanish in daily life tend to record more exclusionary responses. For most questions, the familiarity coefficient is significantly smaller than the coefficient of accented English, but the associated uncertainty is also significantly smaller, indicating that the effect is likely to be consistent.

This extension of the model does not necessarily change the fundamental conclusions of @hopkins. The chief finding, that accented English elicits inclusionary rather than exclusionary responses, remains valid and the effect is unchanged by the new model. Rather, the extension raises questions about the preconditions that would cause positive or negative reactions in response to "culturally distinctive" traits. Contrary to @enos, the data from @hopkins suggest that lack of familiarity does not necessarily result in hostility, nor does prolonged familiarity abate hostility. Further inquiry is needed on the effects of long-term exposure to cultural diversity.

# References